const CACHE_NAME="bartalap-v1.0.2",isLocalhost="localhost"===self.location.hostname||"127.0.0.1"===self.location.hostname,ASSETS_TO_CACHE=isLocalhost?["/","/index.html","/css/main.css","/bundle.js","/images/icon-192x192.png","/images/icon-512x512.png","/images/logo.png","/manifest.json","/favicon.ico"]:["/bartalap/","/bartalap/index.html","/bartalap/css/main.css","/bartalap/bundle.js","/bartalap/images/icon-192x192.png","/bartalap/images/icon-512x512.png","/bartalap/images/logo.png","/bartalap/manifest.json","/bartalap/favicon.ico"];self.addEventListener("install",(e=>{console.log("Service Worker installing..."),e.waitUntil(caches.open(CACHE_NAME).then((e=>(console.log("Caching app shell"),e.addAll(ASSETS_TO_CACHE).catch((e=>(console.warn("Some assets failed to cache:",e),Promise.resolve())))))).then((()=>(console.log("Service Worker installed successfully"),self.skipWaiting()))).catch((e=>{console.error("Service Worker installation failed:",e)})))})),self.addEventListener("activate",(e=>{console.log("Service Worker activating..."),e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>{if(e!==CACHE_NAME)return console.log("Deleting old cache:",e),caches.delete(e)}))))).then((()=>(console.log("Service Worker activated successfully"),self.clients.claim()))))})),self.addEventListener("fetch",(e=>{"GET"===e.request.method&&e.request.url.startsWith(self.location.origin)&&e.respondWith(caches.match(e.request).then((a=>a?(console.log("Serving from cache:",e.request.url),a):(console.log("Fetching from network:",e.request.url),fetch(e.request).then((a=>{if(!a||200!==a.status||"basic"!==a.type)return a;const t=a.clone();return caches.open(CACHE_NAME).then((a=>{a.put(e.request,t)})),a})).catch((a=>{if(console.error("Fetch failed:",a),"document"===e.request.destination)return caches.match(isLocalhost?"/index.html":"/bartalap/index.html");throw a}))))))})),self.addEventListener("sync",(e=>{console.log("Background sync event:",e.tag),"background-sync"===e.tag&&e.waitUntil(console.log("Performing background sync..."))})),self.addEventListener("push",(e=>{if(console.log("Push event received"),e.data){const a=e.data.json(),t={body:a.body,icon:isLocalhost?"/images/icon-192x192.png":"/bartalap/images/icon-192x192.png",badge:isLocalhost?"/images/icon-192x192.png":"/bartalap/images/icon-192x192.png",vibrate:[100,50,100],data:a.data};e.waitUntil(self.registration.showNotification(a.title,t))}})),self.addEventListener("notificationclick",(e=>{console.log("Notification clicked"),e.notification.close(),e.waitUntil(clients.openWindow(isLocalhost?"/":"/bartalap/"))}));